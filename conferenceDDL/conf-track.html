<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Conference Tracking Â· Pro</title>
  <style>
    /* ===== Design tokens ===== */
    :root {
      --bg: #f7f7fb;
      --card: #ffffff;
      --text: #2b2f36;
      --muted: #6b7280;
      --accent: #3a86ff;
      --accent-2: #22c55e;
      --red: #e11d48;
      --orange: #f59e0b;
      --green: #10b981;
      --border: #e5e7eb;
      --shadow: 0 6px 24px rgba(16, 24, 40, 0.06);
      --radius: 14px;
      --sticky-h: 112px; /* header + toolbar height */
    }
    [data-theme="dark"] {
      --bg: #0b1220;
      --card: #0f172a;
      --text: #e5e7eb;
      --muted: #94a3b8;
      --accent: #60a5fa;
      --accent-2: #34d399;
      --border: #1f2937;
      --shadow: 0 8px 28px rgba(0,0,0,0.4);
    }

    * { box-sizing: border-box; }
    html, body { height: 100%; }
    body {
      margin: 0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, "Helvetica Neue", Arial, "Apple Color Emoji", "Segoe UI Emoji";
      color: var(--text);
      background: radial-gradient(1200px 600px at 50% -100px, rgba(58,134,255,0.08), transparent 60%), var(--bg);
      display: flex; flex-direction: column; overflow: hidden;
    }

    /* ===== Header + Toolbar ===== */
    .header {
      position: sticky; top: 0; z-index: 50; background: linear-gradient(#fff0, #fff0), var(--bg);
      backdrop-filter: blur(6px);
    }
    .topbar {
      max-width: 1600px; margin: 10px auto 0; padding: 10px 16px;
      display: flex; align-items: center; justify-content: space-between; gap: 12px;
    }
    .brand { display: flex; align-items: center; gap: 10px; }
    .brand h1 { font-size: 1.3rem; font-weight: 700; margin: 0; letter-spacing: 0.2px; }
    .chip { font-size: 12px; padding: 4px 8px; border: 1px solid var(--border); border-radius: 999px; color: var(--muted); }

    .toolbar {
      max-width: 1600px; margin: 0 auto; padding: 8px 16px 12px; display: grid; gap: 8px; align-items: center;
      grid-template-columns: 1fr repeat(6, max-content);
    }
    .toolbar .field { display: flex; align-items: center; gap: 6px; }
    .toolbar input[type="search"], .toolbar select {
      height: 36px; padding: 0 10px; border: 1px solid var(--border); border-radius: 10px; background: var(--card); color: var(--text);
    }
    .toolbar input[type="search"] { width: 100%; }
    .toolbar .btn {
      border: 1px solid var(--border); background: var(--card); color: var(--text); height: 36px; padding: 0 12px; border-radius: 10px; cursor: pointer;
    }
    .toolbar .btn[data-active="true"] { outline: 2px solid var(--accent); }
    .toolbar .toggle { display: inline-flex; align-items: center; gap: 6px; font-size: 13px; color: var(--muted); }

    .divider { height: 1px; background: var(--border); }

    /* ===== Table/Card area ===== */
    .wrap { max-width: 1600px; margin: 0 auto; flex: 1; width: 100%; display: flex; flex-direction: column; overflow: hidden; }

    .table-header { display: none; }
    .th { display: flex; align-items: center; gap: 6px; justify-content: center; cursor: pointer; user-select: none; }
    .th .sort { font-size: 11px; opacity: 0.8; }

    .table-body { flex: 1; overflow: auto; padding: 8px 16px 16px; }

    .row { display: grid; grid-template-columns: 1fr; align-items: start; gap: 10px; padding: 14px; border: 1px solid var(--border); border-radius: 12px; background: var(--card); box-shadow: var(--shadow); margin-top: 12px; transition: transform .06s ease; }
    .row:hover { transform: translateY(-1px); }

    .cell { text-align: left; padding: 2px 4px; white-space: normal; overflow: visible; text-overflow: initial; }
    .title { display: grid; grid-template-columns: 1fr auto; align-items: center; gap: 8px; }
    .title a { color: var(--accent); text-decoration: none; font-weight: 600; }
    .title .actions { display: inline-flex; align-items: center; gap: 8px; }
    .details { display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 8px; }
    .detail { padding: 6px 8px; border: 1px dashed var(--border); border-radius: 10px; color: var(--muted); background: color-mix(in oklab, var(--card) 90%, transparent); }
    .detail b { color: var(--text); font-weight: 600; margin-right: 6px; }

    .countdown { font-weight: 700; }
    .countdown.green { color: var(--green); }
    .countdown.orange { color: var(--orange); }
    .countdown.red { color: var(--red); }

    .actions { display: inline-flex; gap: 6px; }
    .icon-btn { border: 1px solid var(--border); background: transparent; color: var(--muted); padding: 6px 8px; border-radius: 10px; cursor: pointer; }
    .icon-btn:hover { color: var(--accent); border-color: var(--accent); }

    .empty {
      text-align: center; color: var(--muted); margin-top: 16px; padding: 24px; border: 1px dashed var(--border); border-radius: 12px; background: color-mix(in oklab, var(--card) 86%, transparent);
    }

    .row.closed { background: #f3f4f6; border-color: #e5e7eb; opacity: 0.85; }
    [data-theme="dark"] .row.closed { background: #111827; border-color: #1f2937; opacity: 0.8; }
    .row.closed .title a { color: var(--muted) !important; }
    .row.closed .detail { color: var(--muted); }
    .row.closed .badge { color: var(--muted); border-color: var(--border); }
    .row.closed .countdown { color: var(--muted) !important; }

    /* ===== Responsive (cards on mobile) ===== */
    @media (max-width: 980px) {
      :root { --sticky-h: 160px; }
      .toolbar { grid-template-columns: 1fr 1fr 1fr; grid-auto-rows: min-content; }
      .table-header { display: none; }
      .row { grid-template-columns: 1fr; gap: 8px; }
      .cell { text-align: left; white-space: normal; }
      .title { display: flex; justify-content: space-between; align-items: center; }
      .grid-sm { display: grid; grid-template-columns: repeat(2, 1fr); gap: 6px; }
      .countdown { justify-self: end; }
    }
  </style>
</head>
<body>
  <header class="header" role="banner">
    <div class="topbar">
      <div class="brand" aria-label="Site title">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M4 12a8 8 0 1 1 16 0v6a2 2 0 0 1-2 2h-2v-8a4 4 0 1 0-8 0v8H6a2 2 0 0 1-2-2v-6Z" stroke="currentColor" stroke-width="1.5"/></svg>
        <h1>Conference Tracking</h1>
        <span class="chip" title="Clientâ€‘side only">Noâ€‘backend</span>
      </div>
      <div class="field">
        <button id="themeBtn" class="btn" aria-label="Toggle dark mode">ðŸŒ— Theme</button>
      </div>
    </div>
    <div class="toolbar" role="region" aria-label="Filters and actions">
      <input id="search" type="search" placeholder="Search conferences, venue, acronymâ€¦ (âŒ˜/Ctrl+K)" aria-label="Search" />
      <select id="subject">
        <option value="ALL">All Subjects</option>
        <option>Wireless & Communication</option>
        <option>Security & Privacy</option>
        <option>Networking & Systems</option>
      </select>
      <select id="sort">
        <option value="deadline-asc">Submission DDL â†‘</option>
        <option value="deadline-desc">Submission DDL â†“</option>
        <option value="name-asc">Name Aâ†’Z</option>
        <option value="name-desc">Name Zâ†’A</option>
      </select>
      <label class="toggle"><input type="checkbox" id="onlyOpen" /> Only open</label>
      <label class="toggle"><input type="checkbox" id="onlyFav" /> Only favorites</label>
      <select id="tz">
        <option value="auto">Timezone: Auto</option>
        <option value="Pacific/Honolulu">Timezone: Pacific/Honolulu</option>
        <option value="America/Los_Angeles">Timezone: America/Los_Angeles</option>
        <option value="UTC">Timezone: UTC</option>
      </select>
      <button id="exportCsv" class="btn" title="Export current view">Export CSV</button>
    </div>
    <div class="divider"></div>
  </header>

  <main class="wrap" role="main">
    <div id="cols" class="table-header" aria-hidden="true">
      <div class="th" data-sort="name">Conference <span class="sort">â‡…</span></div>
      <div class="th" data-sort="host">Host Time <span class="sort">â‡…</span></div>
      <div class="th" data-sort="loc">Location <span class="sort">â‡…</span></div>
      <div class="th" data-sort="abs">Abstract DDL <span class="sort">â‡…</span></div>
      <div class="th" data-sort="sub">Submission DDL <span class="sort">â‡…</span></div>
      <div class="th" data-sort="noti">Notification <span class="sort">â‡…</span></div>
      <div class="th" data-sort="left">Time Left <span class="sort">â‡…</span></div>
    </div>
    <section id="list" class="table-body" aria-live="polite"></section>
  </main>

  <template id="row-tpl">
    <article class="row" role="article">
      <div class="cell title">
        <div>
          <a class="link" target="_blank" rel="noopener"></a>
          <span class="meta"></span>
        </div>
        <div class="actions">
          <span class="countdown">â€”</span>
          <button class="icon-btn fav" title="Toggle favorite" aria-label="Toggle favorite">â˜†</button>
          <button class="icon-btn ics" title="Add DDL to Calendar" aria-label="Add deadline to calendar">ðŸ“…</button>
        </div>
      </div>
      <div class="details">
        <div class="detail host"><b>Host:</b> <span class="v"></span></div>
        <div class="detail loc"><b>Location:</b> <span class="v"></span></div>
        <div class="detail abs"><b>Abstract DDL:</b> <span class="v"></span></div>
        <div class="detail sub"><b>Submission DDL:</b> <span class="v"></span></div>
        <div class="detail noti"><b>Notification:</b> <span class="v"></span></div>
      </div>
    </article>
  </template>

  <section id="empty" class="empty" hidden>
    No conferences match your filters. Try clearing the search or toggles.
  </section>

  <script>
    // ===== Utils =====
    const $ = (sel, el=document) => el.querySelector(sel);
    const $$ = (sel, el=document) => Array.from(el.querySelectorAll(sel));

    const state = {
      confs: [],
      filtered: [],
      subject: 'ALL',
      sort: 'deadline-asc',
      onlyOpen: false,
      onlyFav: false,
      search: '',
      tz: 'auto',
      favs: new Set(JSON.parse(localStorage.getItem('favConfs') || '[]')),
    };

    function saveFavs(){ localStorage.setItem('favConfs', JSON.stringify([...state.favs])); }

    // Robust date sanitization: accepts "YYYY-MM-DD", "MMM DD, YYYY", ISO, and strips <strike>
    function cleanDateStr(s){
      if(!s) return '';
      return String(s).replace(/<\/?strike>/g, '').trim();
    }

    function parseDate(s){
      if(!s) return null;
      s = cleanDateStr(s);
      // ISO or YYYY-MM-DD
      const iso = Date.parse(s);
      if(!Number.isNaN(iso)) return new Date(iso);
      // "Jan 05 2026" or "Jan 5, 2026"
      const m = s.match(/^(\w{3,})\s(\d{1,2}),?\s(\d{4})$/);
      if(m) return new Date(`${m[1]} ${m[2]}, ${m[3]}`);
      return null;
    }

    function fmtDate(d, opts={}){
      if(!d) return '';
      const tz = state.tz === 'auto' ? undefined : state.tz;
      try {
        return d.toLocaleDateString('en-US', { year:'numeric', month:'short', day:'2-digit', timeZone: tz, ...opts });
      } catch { return d.toLocaleDateString('en-US', { year:'numeric', month:'short', day:'2-digit' }); }
    }

    function fmtHost(start, end){
      const s = parseDate(start), e = parseDate(end);
      if(!s || !e) return '';
      const tz = state.tz === 'auto' ? undefined : state.tz;
      const month = s.toLocaleDateString('en-US', { month:'short', timeZone: tz });
      const sd = s.toLocaleDateString('en-US', { day:'2-digit', timeZone: tz });
      const ed = e.toLocaleDateString('en-US', { day:'2-digit', timeZone: tz });
      const year = s.toLocaleDateString('en-US', { year:'numeric', timeZone: tz });
      return `${month} ${sd}â€“${ed}, ${year}`;
    }

    function daysLeft(deadStr){
      const d = parseDate(deadStr);
      if(!d) return { text:'â€”', cls:'', closed:false, d:null };
      const now = new Date();
      const diffMs = d - now;
      const closed = diffMs < 0;
      if(closed) return { text:'Closed', cls:'red', closed:true, d };
      const secTotal = Math.floor(diffMs / 1000);
      const days = Math.floor(secTotal / 86400);
      const hours = Math.floor((secTotal % 86400) / 3600);
      const mins = Math.floor((secTotal % 3600) / 60);
      const secs = secTotal % 60;
      const pad2 = n => String(n).padStart(2, '0');
      const text = `${days}d ${pad2(hours)}:${pad2(mins)}:${pad2(secs)}`;
      const cls = days <= 20 ? 'orange' : 'green';
      return { text, cls, closed:false, d };
    }

    function debounce(fn, wait=250){ let t; return (...args)=>{ clearTimeout(t); t=setTimeout(()=>fn(...args), wait); } }

    function icsFor(conf){
      const name = conf.name || conf.Conference || 'Conference';
      const dlStr = conf['Submission Deadline'] || conf.deadline || '';
      const d = parseDate(dlStr);
      if(!d) return null;
      const pad = n=> String(n).padStart(2,'0');
      // all-day event on deadline date in UTC
      const y=d.getUTCFullYear(), m=pad(d.getUTCMonth()+1), day=pad(d.getUTCDate());
      const DTSTART = `${y}${m}${day}`;
      const UID = `${y}${m}${day}-${encodeURIComponent(name)}@conftracker`;
      const desc = `Submission deadline for ${name}. ${conf.link?('Link: '+conf.link):''}`.trim();
      const ics = `BEGIN:VCALENDAR\nVERSION:2.0\nPRODID:-//ConfTracker//EN\nCALSCALE:GREGORIAN\nMETHOD:PUBLISH\nBEGIN:VEVENT\nUID:${UID}\nDTSTAMP:${y}${m}${day}T000000Z\nDTSTART;VALUE=DATE:${DTSTART}\nSUMMARY:Submission DDL â€” ${name}\nDESCRIPTION:${desc.replace(/\n/g,' ')}\nEND:VEVENT\nEND:VCALENDAR`;
      return new Blob([ics], { type: 'text/calendar' });
    }

    function toCSV(rows){
      const header = ['Conference','Host Time','Location','Abstract DDL','Submission DDL','Notification','Days Left'];
      const esc = s=> '"'+String(s??'').replaceAll('"','""')+'"';
      const lines = [header.join(',')];
      for(const r of rows){
        const dl = daysLeft(r['Submission Deadline']||r.deadline);
        lines.push([
          r.name||r.Conference||'',
          fmtHost(r['Start Date'], r['End Date']),
          r.Location||'',
          fmtDate(parseDate(r['Abstract Deadline']||'')),
          fmtDate(parseDate(r['Submission Deadline']||r.deadline||'')),
          fmtDate(parseDate(r.Notification||'')),
          dl.text
        ].map(esc).join(','));
      }
      return new Blob([lines.join('\n')], {type:'text/csv'});
    }

    // ===== Rendering =====
    const $list = $('#list'), $tpl = $('#row-tpl'), $empty = $('#empty');

    function applyFilters(){
      const q = state.search.trim().toLowerCase();
      let rows = state.confs.filter(c => {
        const name = (c.name || c.Conference || '').toLowerCase();
        const sub = (c.sub || '').toLowerCase();
        const okSub = state.subject === 'ALL' || sub.includes(state.subject.toLowerCase());
        const okSearch = !q || name.includes(q) || (c.Location||'').toLowerCase().includes(q);
        const dl = daysLeft(c['Submission Deadline']||c.deadline);
        const okOpen = !state.onlyOpen || !dl.closed;
        const okFav = !state.onlyFav || state.favs.has((c.link || c.name || c.Conference || ''));
        return okSub && okSearch && okOpen && okFav;
      });

      const keyers = {
        'deadline-asc': c => parseDate(c['Submission Deadline']||c.deadline)?.getTime() ?? 9e15,
        'deadline-desc': c => -(parseDate(c['Submission Deadline']||c.deadline)?.getTime() ?? 0),
        'name-asc': c => (c.name||c.Conference||'').toLowerCase(),
        'name-desc': c => '\uFFFF'+(c.name||c.Conference||'').toLowerCase(),
      };
      const keyer = keyers[state.sort] || keyers['deadline-asc'];
      rows.sort((a,b)=>{ const dla = daysLeft(a['Submission Deadline']||a.deadline); const dlb = daysLeft(b['Submission Deadline']||b.deadline); if(dla.closed !== dlb.closed) return dla.closed ? 1 : -1; const ka = keyer(a); const kb = keyer(b); return ka>kb?1:ka<kb?-1:0; });

      state.filtered = rows;
      renderList();
    }

    function renderList(){
      $list.innerHTML = '';
      if(!state.filtered.length){ $empty.hidden = false; return; } else { $empty.hidden = true; }

      const frag = document.createDocumentFragment();
      for(const c of state.filtered){
        const el = $tpl.content.cloneNode(true);
        const title = $('.link', el);
        const meta = $('.meta', el);
        const host = $('.host .v', el);
        const loc = $('.loc .v', el);
        const abs = $('.abs .v', el);
        const sub = $('.sub .v', el);
        const noti = $('.noti .v', el);
        const left = $('.countdown', el);
        const favBtn = $('.fav', el);
        const icsBtn = $('.ics', el);

        const name = c.name || c.Conference || 'â€”';
        title.textContent = name;
        title.href = c.link || '#';
        title.setAttribute('aria-label', `Open ${name} website`);

        meta.innerHTML = '';
        if(c.sub) { const b = document.createElement('span'); b.className='badge'; b.textContent = c.sub; meta.appendChild(b); }
        if(c.ccf) { const b = document.createElement('span'); b.className='badge'; b.textContent = `CCF ${c.ccf}`; meta.appendChild(b); }

        host.textContent = fmtHost(c['Start Date'], c['End Date']);
        loc.textContent = c.Location || '';
        abs.textContent = fmtDate(parseDate(c['Abstract Deadline']||''));
        const subD = c['Submission Deadline'] || c.deadline || '';
        sub.textContent = fmtDate(parseDate(subD));
        noti.textContent = fmtDate(parseDate(c.Notification||''));

        const dl = daysLeft(subD);
        left.textContent = dl.text; left.className = `countdown ${dl.cls}`;

        // Mark closed entries for gray style
        const article = el.querySelector('.row');
        if(dl.closed){ article.classList.add('closed'); }

        const favKey = c.link || c.name || c.Conference || '';
        const favOn = state.favs.has(favKey);
        favBtn.textContent = favOn ? 'â˜…' : 'â˜†';
        favBtn.ariaPressed = String(favOn);
        favBtn.addEventListener('click', ()=>{
          if(state.favs.has(favKey)) state.favs.delete(favKey); else state.favs.add(favKey);
          saveFavs(); applyFilters();
        });

        icsBtn.addEventListener('click', ()=>{
          const blob = icsFor(c);
          if(!blob){ alert('No valid submission deadline to add.'); return; }
          const url = URL.createObjectURL(blob);
          const a = document.createElement('a');
          a.href = url; a.download = `${(name||'conf').replace(/[^a-z0-9]+/gi,'_')}_submission_ddl.ics`;
          document.body.appendChild(a); a.click(); a.remove();
          setTimeout(()=>URL.revokeObjectURL(url), 2000);
        });

        frag.appendChild(el);
      }
      $list.appendChild(frag);
    }

    // ===== Data =====
    async function fetchData(){
      const url = 'https://raw.githubusercontent.com/nexuseli18/conf-tracker/refs/heads/master/conferences.json';
      try {
        const res = await fetch(url, { cache:'no-store' });
        if(!res.ok) throw new Error(res.status + ' ' + res.statusText);
        const data = await res.json();
        state.confs = Array.isArray(data) ? data : [];
        applyFilters();
      } catch (e) {
        console.error('Failed to load conferences:', e);
        $('#empty').hidden = false; $('#empty').textContent = 'Failed to load conference data. Check your network or data format.';
      }
    }

    // ===== Events =====
    $('#search').addEventListener('input', debounce(e=>{ state.search = e.target.value; applyFilters(); }, 120));
    $('#subject').addEventListener('change', e=>{ state.subject = e.target.value; applyFilters(); });
    $('#sort').addEventListener('change', e=>{ state.sort = e.target.value; applyFilters(); });
    $('#onlyOpen').addEventListener('change', e=>{ state.onlyOpen = e.target.checked; applyFilters(); });
    $('#onlyFav').addEventListener('change', e=>{ state.onlyFav = e.target.checked; applyFilters(); });
    $('#exportCsv').addEventListener('click', ()=>{
      const blob = toCSV(state.filtered);
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url; a.download = 'conferences.csv';
      document.body.appendChild(a); a.click(); a.remove();
      setTimeout(()=>URL.revokeObjectURL(url), 1500);
    });

    // Timezone default: if running in HawaiÊ»i, default to Pacific/Honolulu; else auto.
    const hawaiiTZ = 'Pacific/Honolulu';
    const tzGuess = Intl.DateTimeFormat().resolvedOptions().timeZone || 'auto';
    if(tzGuess === hawaiiTZ){ $('#tz').value = hawaiiTZ; state.tz = hawaiiTZ; } else { state.tz = 'auto'; }
    $('#tz').addEventListener('change', e=>{ state.tz = e.target.value; applyFilters(); });

    // Keyboard focus for search
    window.addEventListener('keydown', (e)=>{
      if((e.ctrlKey || e.metaKey) && e.key.toLowerCase() === 'k'){ e.preventDefault(); $('#search').focus(); }
    });

    // Theme toggle
    const themeBtn = $('#themeBtn');
    const themeKey = 'confTheme';
    const savedTheme = localStorage.getItem(themeKey);
    if(savedTheme) document.documentElement.setAttribute('data-theme', savedTheme);
    themeBtn.addEventListener('click', ()=>{
      const cur = document.documentElement.getAttribute('data-theme');
      const next = cur === 'dark' ? '' : 'dark';
      if(next) document.documentElement.setAttribute('data-theme', next); else document.documentElement.removeAttribute('data-theme');
      localStorage.setItem(themeKey, next);
    });

    // Live countdown refresh (every second)
    setInterval(()=>{
      $$('#list .row').forEach((row, idx)=>{
        const c = state.filtered[idx];
        if(!c) return;
        const dl = daysLeft(c['Submission Deadline']||c.deadline);
        const el = row.querySelector('.countdown');
        if(el){ el.textContent = dl.text; el.className = `countdown ${dl.cls}`; }
        if(dl.closed) row.classList.add('closed');
      });
    }, 1000);

    // ===== Developer smoke tests (non-intrusive) =====
    function runSelfTests(){
      try {
        console.groupCollapsed('%cConfTracker tests','color:#3a86ff');
        // parseDate tests
        console.assert(parseDate('1970-01-01') instanceof Date, 'parseDate(YYYY-MM-DD) should work');
        console.assert(parseDate('Jan 05, 2030') instanceof Date, 'parseDate(MMM DD, YYYY) should work');
        console.assert(parseDate('Jan 5 2030') instanceof Date, 'parseDate(MMM D YYYY) should work');
        // daysLeft future format
        const future = new Date(Date.now() + 36*3600*1000).toISOString().slice(0,10);
        const dlF = daysLeft(future);
        console.assert(/\dd \d{2}:\d{2}:\d{2}/.test(dlF.text), 'daysLeft should format as Xd HH:MM:SS');
        console.assert(dlF.closed === false, 'daysLeft for future should not be closed');
        // daysLeft closed
        const dlP = daysLeft('1970-01-01');
        console.assert(dlP.closed === true && dlP.text === 'Closed', 'daysLeft should mark closed');
        // sorting closed last
        const mock = [{deadline: future, name:'A'}, {deadline: '1970-01-01', name:'B'}];
        state.confs = mock;
        state.subject = 'ALL'; state.search=''; state.onlyOpen=false; state.onlyFav=false; state.sort='deadline-asc';
        applyFilters();
        console.assert(state.filtered[0].name==='A' && state.filtered[1].name==='B', 'Closed conferences should sort last');
        console.groupEnd();
      } catch (e) {
        console.warn('Self tests encountered an error:', e);
      }
    }

    // Init
    fetchData();
    runSelfTests();
  </script>
</body>
</html>
